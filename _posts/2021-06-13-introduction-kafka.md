---drawiolayout: posts
title: 메시징 시스템 
date: 2021-06-13 17:28:00 +0900
categories: data/message
pagination: 
  enabled: true
  category: data/message
  permalink: /:num/
tags:
  - kafka
  - messaging-system
  - introduction
---

## 카프카 유래

LinkediN에서 로그수집 시스템을 위해 만들어진 오픈소스로 현재는 Apache재단에서 관리중

포털에서 사용자 활동 데이터를 수집하는데 사용

이전에는 오픈소스 기반으로 ETL도구를 써서 예전 XML기반 로깅서비스 형태로 만들어졌다.
잘 동작하지 않아서 카프카 제작

## 카프카 목표

- 분산시스템을 지원
- 내결함성
- 게시/구독 시스템
- 메시지 프로듀서와 컨슈머 사이의 느슨한 연계
- 다양한 형태의 데이터 사용 시나리오와 장애 처리 지원을 위한 메시지 데이터 유지
- 빠른 처리 시간을 지원하는 구성 요소로 시스템의 전반적인 처리량을 최대화
- 이진 데이터 형식을 사용해서 다양한 데이터 형식과 유형을 관리
- 기존의 클러스터 구성에 영향을 주지 않고 일정한 서버의 확장성을 지원

## 카프카 특징

- Scala on JVM
- 모든 메시지는 영구적인 파일시스템 로그로 저장
- 로그 선행 기입(WAL, write-ahead logging) 시스템으로 모든 게시된 메시지를 컨슈머 프로그램에 사용하기 전에 로그 파일로 기록한다

## 카프카 구조

- Message: 바이너리 형태로 전송되는 데이터 최소단위
- Topic: Message를 바이트의 집합으로 배열로 표현
- Producer: 프로듀서는 큐에 정보를 저장하는 애플리케이션이다. 
  선행 기입 파일 마지막에 메시지를 추가
- Queue: 정보가 저장된 배열로 추상화
- Partition: 토픽은 파티션으로 나눠진다
- Consumer: 토픽 파티션에 속한 로그 파일에서 메시지를 가져온다

## 카프카 클러스터 구조도

### 논리구조
drawio

프로듀서는 하나 이상의 파티션을 소유하는 토픽으로 메시지를 전달
컨슈머로 푸시

### 물리구조
drawio

파티션

